<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Styled Table</title>
    <style>
    body {
        font-family: Calibri;
    }

    table {
        width: 60%;
        border-collapse: collapse;
        border: 2px solid black; /* Add thick border around the table */
    
    }


    th, td {
        border: 1px solid #000;
        padding: 0px; /* Reduce padding to make cells smaller */
        text-align: center;
        white-space: nowrap; /* Prevent text wrapping */
        font-size: 15px; /* Decrease font size */
        font-weight: normal;
    }

    th {
        font-weight: bold;
    }
    .header-in-table{
        background-color: #70AD47;
    }

    /* Set specific cell height and width */
    td, th {
        height: 20px;  /* Adjust this value to set cell height */
        width: 45px;  /* Adjust this value to set cell width */
    }

    /* Apply specific styles for colored cells */
    .sunrise-today {
        background-color: #ED7D31;
    }

    .sunset-today {
        background-color: #FF0000;
    }

    .blue-background {
        background-color:#002060;
    }

    .sunrise-tmrw {
        background-color:#FFD966;
    }
    </style>
</head>
<body>
 <!--   <label for="sunriseToday">Sunrise Today:</label>
    <input type="time" id="sunriseToday" name="sunriseToday" value="05:45">
    <label for="sunsetToday">Sunset Today:</label>
    <input type="time" id="sunsetToday" name="sunsetToday" value="18:04">
    <label for="sunriseTmrw">Sunrise Tomorrow:</label>
    <input type="time" id="sunriseTmrw" name="sunriseTmrw" value="05:45">
    <label for="weekday">Weekday:</label>
    <input type="text" id="weekday" name="weekday" value="Monday">
    <button onclick="updateTable()">Update Table</button>  -->

      <label for="sunriseToday">Sunrise Today:</label>
    <input id="sunriseToday" name="sunriseToday" value="05:45:00">
    <label for="sunsetToday">Sunset Today:</label>
    <input id="sunsetToday" name="sunsetToday" value="18:04:00">
    <label for="sunriseTmrw">Sunrise Tomorrow:</label>
    <input id="sunriseTmrw" name="sunriseTmrw" value="05:45:00">
    <label for="weekday">Weekday:</label>
    <input type="text" id="weekday" name="weekday" value="Monday">
    <button onclick="updateTable()">Update Table</button> 

    <table>
        <thead>
            <tr>
                <th class="header-in-table">STRAT</th>
                <th class="header-in-table">END</th>
                <th class="header-in-table" id="weekday-html">Monday</th>
                <th class="header-in-table">STRAT</th>
                <th class="header-in-table">END</th>
                <th class="header-in-table">S.no</th>
                <th></th>
                <th></th>
            </tr>
        </thead>
        <tbody id="table-body">
            <!-- Table rows will be generated by JavaScript -->
        </tbody>
    </table>

    <script>
        function timeToSeconds(time) {
            const [hours, minutes, seconds] = time.split(':').map(Number);
            return hours * 3600 + minutes * 60 + (seconds || 0);
        }
        
        function secondsToTime(seconds) {
            seconds = Math.round(seconds % 86400); // Ensure seconds wrap around after 24 hours and round to nearest second
            const hrs = Math.floor(seconds / 3600);
            const mins = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            return `${String(hrs).padStart(2, '0')}:${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }


        function updateTable() {
            const sunriseToday = document.getElementById('sunriseToday').value ;
            const sunsetToday = document.getElementById('sunsetToday').value ;
            const sunriseTmrw = document.getElementById('sunriseTmrw').value ;
            const weekday = document.getElementById('weekday').value;
            const total = "24:00:00";
            console.log("sunriseToday", sunriseToday);
            console.log("sunsetToday", sunsetToday);
            console.log("sunriseTmrw", sunriseTmrw);
            console.log("total", total);

            const sunriseTodaySec = timeToSeconds(sunriseToday);
            const sunsetTodaySec = timeToSeconds(sunsetToday);
            const sunriseTmrwSec = timeToSeconds(sunriseTmrw);
            const totalSec = timeToSeconds(total);
            console.log("sunriseTodaySec", sunriseTodaySec);
            console.log("sunsetTodaySec", sunsetTodaySec);
            console.log("sunriseTmrwSec", sunriseTmrwSec);
            console.log("totalSec", totalSec);

            const interval1 = (sunsetTodaySec - sunriseTodaySec) / 30;
            const interval2 = ((totalSec + sunriseTmrwSec) - sunsetTodaySec) / 30;
            console.log("interval1", interval1);
            console.log("interval2", interval2);
            const tableBody = document.getElementById('table-body');
            tableBody.innerHTML = ''; // Clear existing table rows
            

            let currentSec = sunriseTodaySec;
            const columnD = [];

            // Generate rows for 30 cells
            for (let i = 0; i < 30; i++) {
                const start = secondsToTime(currentSec);
                currentSec += interval1;
                const end = secondsToTime(currentSec);

                tableBody.innerHTML += `
                    <tr>
                        <td>${start}</td>
                        <td>${end}</td>
                        <td></td>
                        <td></td> <!-- Placeholder for Column D -->
                        <td></td> <!-- Placeholder for Column E -->
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                    </tr>
                `;
                columnD.push(end); // Store values for column D
            }

            // Column D calculation (starting from A32) and Column E setup
            const rows = tableBody.querySelectorAll('tr');
            let previousD = timeToSeconds(columnD[29]); // Start with the last value from columnD
// Levenshtein distance function
function levenshtein(a, b) {
    let tmp;
    let i, j;
    const alen = a.length;
    const blen = b.length;
    const arr = [];
    
    if (alen === 0) { return blen; }
    if (blen === 0) { return alen; }

    for (i = 0; i <= blen; i++) { arr[i] = [i]; }
    for (j = 0; j <= alen; j++) { arr[0][j] = j; }

    for (i = 1; i <= blen; i++) {
        for (j = 1; j <= alen; j++) {
            tmp = a[j - 1] === b[i - 1] ? 0 : 1;
            arr[i][j] = Math.min(arr[i - 1][j] + 1, arr[i][j - 1] + 1, arr[i - 1][j - 1] + tmp);
        }
    }

    return arr[blen][alen];
}

// Possible correct day names
const dayNames = {
    "Monday": ["monday", "mon", "mondy", "moday"],
    "Tuesday": ["tuesday", "tues", "tuesd", "tueday"],
    "Wednesday": ["wednesday", "wed", "wednes", "wensday"],
    "Thursday": ["thursday", "thur", "thurs", "thurday"],
    "Friday": ["friday", "fri", "frid", "fryday"],
    "Saturday": ["saturday", "sat", "satur", "saterday"],
    "Sunday": ["sunday", "sun", "sund", "sundey"]
};

// Find the closest match for a given input
function findClosestDay(input) {
    let minDistance = Infinity;
    let closestDay = "";
    
    const normalizedInput = input.toLowerCase();
    
    for (const [day, variants] of Object.entries(dayNames)) {
        for (const variant of variants) {
            const distance = levenshtein(normalizedInput, variant.toLowerCase());
            if (distance < minDistance) {
                minDistance = distance;
                closestDay = day;
            }
        }
    }
    
    return closestDay;
}

for (let i = 0; i < rows.length; i++) {
    const cells = rows[i].querySelectorAll('td');
    if (cells.length >= 5) {
        // Update Column D values
        if (i === 0) {
            cells[3].textContent = secondsToTime(previousD); // D2 = A32
        } else {
            previousD += interval2;
            cells[3].textContent = secondsToTime(previousD); // D[i] = D[i-1] + interval1
        }

        // Update Column E with next Column D value
        if (i < rows.length) {
            const nextD = timeToSeconds(cells[3].textContent);
            cells[4].textContent = secondsToTime(nextD + interval2); // E[i] = D[i+1]
        }

        let wkd = document.getElementById("weekday-html");
        let closestDay = findClosestDay(weekday); // Find the closest day name

        // Apply blue background to specific rows in Column C based on closest day
        const dayVariants = {
            "Monday": [0, 5, 12, 13, 21 , 26, 29],
            "Tuesday": [4, 9, 10, 11, 13, 14, 15, 16, 17, 20, 22, 23, 24, 26],
            "Wednesday": [2, 3, 6, 7, 8, 9, 11, 21, 29, 31],
            "Thursday": [4, 7, 10, 15, 16, 17, 18, 20, 21, 22, 25, 26, 29, 30],
            "Friday": [3, 6, 8, 10, 16, 18, 20, 21, 24, 25, 26, 27, 28, 30],
            "Saturday": [2, 10, 11, 13, 14, 19, 24, 25, 27],
            "Sunday": [2, 10, 11, 13, 14, 19, 24, 25, 27]
        };

        if (dayVariants[closestDay] && dayVariants[closestDay].includes(i)) {
            cells[2].style.backgroundColor = '#002060'; // Apply blue color
            wkd.innerHTML = closestDay;
        }


                    const update = [0,1,2,3,4,5]
                    console.log("update.includes(i)",update.includes(i))
                    if (update.includes(i)) { 
                        if (update[i]==0){
                                cells[6].textContent =secondsToTime(interval1)
                                cells[6].style.backgroundColor = '#B4C6E7';  
                        }
                        if (update[i]==1){
                                cells[6].textContent =secondsToTime(interval2) 
                                cells[6].style.backgroundColor = '#B4C6E7';  
                        }
                        if (update[i]==2){
                                cells[6].textContent =total 
                                cells[6].style.backgroundColor = '#B4C6E7';   
                        }
                        if (update[i]==3){
                                cells[6].textContent ="sunriseToday"
                                cells[7].textContent = sunriseToday
                                cells[6].style.backgroundColor = '#ED7D31'; 
                                cells[7].style.backgroundColor = ''; 
                        }
                        if (update[i]==4){
                                cells[6].textContent ="sunsetToday"
                                cells[7].textContent = sunsetToday  
                                cells[6].style.backgroundColor = '#FF0000'; 
                                cells[7].style.backgroundColor = '';  
                        }
                        if (update[i]==5){
                                cells[6].textContent ="sunriseTmrw"
                                cells[7].textContent = sunriseTmrw   
                                cells[6].style.backgroundColor = '#FFD966'; 
                                cells[7].style.backgroundColor = ''; 
                        }
                }

                }
            }

            const lastA = secondsToTime(currentSec);
            // Calculate the last cell for column D
            const lastD = secondsToTime(previousD + interval2);

            // Append the last row with specific values for columns A and D
            const lastRow = document.createElement('tr');
            lastRow.innerHTML = `
                <td>${lastA}</td>
                <td></td>
                <td></td>
                <td>${lastD}</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            `;
            tableBody.appendChild(lastRow);
        }

        document.addEventListener("DOMContentLoaded", function() {
            updateTable();
        });
    </script>
</body>
</html>
